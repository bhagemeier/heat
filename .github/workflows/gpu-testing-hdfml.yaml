name: GPU Testing Workflow on HDFML machine

on:
  push:
    branches:
      - gpu-test-automation

jobs:
  run-gpu-tests:
    name: run tests on gpu
    runs-on: ubuntu-latest
    steps:
      - uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.HDFML_HOST }}
          username: ${{ secrets.HDFML_NAME }}
          key: ${{ secrets.HDFML_KEY }}
          envs: GITHUB_SHA
          script: |
            cd  ~/heat
            git fetch
            git checkout $GITHUB_SHA
            SHA=$GITHUB_SHA
            TOKEN=${{ secrets.STATUS_TOKEN }}
            TEST=${{ secrets.TEST }}
            export SHA
            export TOKEN
#            ./.github/workflows/gpu_test_run.sh
